<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MongoDB | å‰ç«¯ç¬”è®°</title>
    <meta name="description" content="Welcome to my VuePress site">
    <link rel="icon" href="/assets/images/F_1.png">
    
    <link rel="preload" href="/assets/css/0.styles.92bf089a.css" as="style"><link rel="preload" href="/assets/js/app.260082ab.js" as="script"><link rel="preload" href="/assets/js/2.abe796d4.js" as="script"><link rel="preload" href="/assets/js/13.92e9db98.js" as="script"><link rel="prefetch" href="/assets/js/10.9dabb9bd.js"><link rel="prefetch" href="/assets/js/11.04035704.js"><link rel="prefetch" href="/assets/js/12.e14b5709.js"><link rel="prefetch" href="/assets/js/14.d32119f6.js"><link rel="prefetch" href="/assets/js/15.b13a1f1f.js"><link rel="prefetch" href="/assets/js/16.bcfbc81c.js"><link rel="prefetch" href="/assets/js/17.3d0adf24.js"><link rel="prefetch" href="/assets/js/18.4db57ccc.js"><link rel="prefetch" href="/assets/js/19.824583e5.js"><link rel="prefetch" href="/assets/js/20.5a1c82f0.js"><link rel="prefetch" href="/assets/js/21.d73d9897.js"><link rel="prefetch" href="/assets/js/22.d4e79057.js"><link rel="prefetch" href="/assets/js/23.3543db86.js"><link rel="prefetch" href="/assets/js/24.3f2eb633.js"><link rel="prefetch" href="/assets/js/25.9972ea34.js"><link rel="prefetch" href="/assets/js/26.d0eca9ed.js"><link rel="prefetch" href="/assets/js/27.45e32bd3.js"><link rel="prefetch" href="/assets/js/28.915e2ce3.js"><link rel="prefetch" href="/assets/js/29.a284cff2.js"><link rel="prefetch" href="/assets/js/3.a1169938.js"><link rel="prefetch" href="/assets/js/30.10f563a6.js"><link rel="prefetch" href="/assets/js/31.42548ff5.js"><link rel="prefetch" href="/assets/js/32.27478723.js"><link rel="prefetch" href="/assets/js/33.0154ac26.js"><link rel="prefetch" href="/assets/js/34.0e3d4729.js"><link rel="prefetch" href="/assets/js/35.d26159f8.js"><link rel="prefetch" href="/assets/js/36.54f8be42.js"><link rel="prefetch" href="/assets/js/37.bd0afcd3.js"><link rel="prefetch" href="/assets/js/38.991db0ba.js"><link rel="prefetch" href="/assets/js/39.35285429.js"><link rel="prefetch" href="/assets/js/4.59d9b613.js"><link rel="prefetch" href="/assets/js/40.85e29937.js"><link rel="prefetch" href="/assets/js/41.387737d6.js"><link rel="prefetch" href="/assets/js/42.66c03d2d.js"><link rel="prefetch" href="/assets/js/43.74c52532.js"><link rel="prefetch" href="/assets/js/44.43a2384f.js"><link rel="prefetch" href="/assets/js/45.e1fc99da.js"><link rel="prefetch" href="/assets/js/46.a680b675.js"><link rel="prefetch" href="/assets/js/47.081c6beb.js"><link rel="prefetch" href="/assets/js/48.093db127.js"><link rel="prefetch" href="/assets/js/49.051b2e12.js"><link rel="prefetch" href="/assets/js/5.f573f0ae.js"><link rel="prefetch" href="/assets/js/50.3760412c.js"><link rel="prefetch" href="/assets/js/51.1c230dfd.js"><link rel="prefetch" href="/assets/js/52.84c4fc59.js"><link rel="prefetch" href="/assets/js/6.0c2501b3.js"><link rel="prefetch" href="/assets/js/7.b9517656.js"><link rel="prefetch" href="/assets/js/8.d39559a9.js"><link rel="prefetch" href="/assets/js/9.c4986c38.js">
    <link rel="stylesheet" href="/assets/css/0.styles.92bf089a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/images/F_1.png" alt="å‰ç«¯ç¬”è®°" class="logo"> <span class="site-name can-hide">å‰ç«¯ç¬”è®°</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/home/base.html" class="nav-link">æŒ‡å—</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç¬”è®°" class="dropdown-title"><span class="title">ç¬”è®°</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/PE/nginx.html" class="nav-link">PE</a></li><li class="dropdown-item"><!----> <a href="/vue/dataBinding.html" class="nav-link">vue</a></li><li class="dropdown-item"><!----> <a href="/flutter/base.html" class="nav-link">flutter</a></li><li class="dropdown-item"><!----> <a href="/node/koa2.html" class="nav-link">node</a></li><li class="dropdown-item"><!----> <a href="/rules/eslint.html" class="nav-link">ä»£ç è§„èŒƒ</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å›½é™…åŒ–" class="dropdown-title"><span class="title">å›½é™…åŒ–</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">å›½é™…åŒ–?ä¸å­˜åœ¨çš„ğŸ˜‚</a></li></ul></div></div><div class="nav-item"><a href="/leaveMessage/base.html" class="nav-link">ç•™è¨€</a></div> <a href="https://github.com/duanxiongfei-2016/notes.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/home/base.html" class="nav-link">æŒ‡å—</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç¬”è®°" class="dropdown-title"><span class="title">ç¬”è®°</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/PE/nginx.html" class="nav-link">PE</a></li><li class="dropdown-item"><!----> <a href="/vue/dataBinding.html" class="nav-link">vue</a></li><li class="dropdown-item"><!----> <a href="/flutter/base.html" class="nav-link">flutter</a></li><li class="dropdown-item"><!----> <a href="/node/koa2.html" class="nav-link">node</a></li><li class="dropdown-item"><!----> <a href="/rules/eslint.html" class="nav-link">ä»£ç è§„èŒƒ</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å›½é™…åŒ–" class="dropdown-title"><span class="title">å›½é™…åŒ–</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">å›½é™…åŒ–?ä¸å­˜åœ¨çš„ğŸ˜‚</a></li></ul></div></div><div class="nav-item"><a href="/leaveMessage/base.html" class="nav-link">ç•™è¨€</a></div> <a href="https://github.com/duanxiongfei-2016/notes.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/node/koa2.html" class="sidebar-link">Koa2</a></li><li><a href="/node/mongoDB.html" class="active sidebar-link">MongoDB</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/node/mongoDB.html#mongodb-ä»‹ç»" class="sidebar-link">MongoDB ä»‹ç»</a></li><li class="sidebar-sub-header"><a href="/node/mongoDB.html#æ¦‚å¿µ" class="sidebar-link">æ¦‚å¿µ</a></li><li class="sidebar-sub-header"><a href="/node/mongoDB.html#å®˜ç½‘é“¾æ¥" class="sidebar-link">å®˜ç½‘é“¾æ¥</a></li><li class="sidebar-sub-header"><a href="/node/mongoDB.html#å®‰è£…" class="sidebar-link">å®‰è£…</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/node/mongoDB.html#macå®‰è£…" class="sidebar-link">macå®‰è£…</a></li><li class="sidebar-sub-header"><a href="/node/mongoDB.html#æœåŠ¡å™¨centeroså®‰è£…" class="sidebar-link">æœåŠ¡å™¨CenterOSå®‰è£…</a></li></ul></li><li class="sidebar-sub-header"><a href="/node/mongoDB.html#mongoose" class="sidebar-link">mongoose</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/node/mongoDB.html#å®‰è£…mongoose" class="sidebar-link">å®‰è£…mongoose</a></li><li class="sidebar-sub-header"><a href="/node/mongoDB.html#å¼•å…¥mongooseå¹¶è¿æ¥mongodb" class="sidebar-link">å¼•å…¥mongooseå¹¶è¿æ¥mongodb</a></li><li class="sidebar-sub-header"><a href="/node/mongoDB.html#schema" class="sidebar-link">schema</a></li><li class="sidebar-sub-header"><a href="/node/mongoDB.html#schemaè‡ªå®šä¹‰æ¨¡å¼ä¿®é¥°ç¬¦-setters-getters" class="sidebar-link">schemaè‡ªå®šä¹‰æ¨¡å¼ä¿®é¥°ç¬¦ Setters &amp; Getters</a></li></ul></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="mongodb"><a href="#mongodb" aria-hidden="true" class="header-anchor">#</a> MongoDB</h1> <h2 id="mongodb-ä»‹ç»"><a href="#mongodb-ä»‹ç»" aria-hidden="true" class="header-anchor">#</a> MongoDB ä»‹ç»</h2> <blockquote><p>MongoDBæ˜¯ä¸€ä¸ªç”¨jsonï¼ˆbsonï¼‰æ ¼å¼å­˜å‚¨çš„æ•°æ®åº“</p></blockquote> <h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" aria-hidden="true" class="header-anchor">#</a> æ¦‚å¿µ</h2> <blockquote><p>ä¸€ä¸ªmangoDBæœ‰å¯ä»¥æ”¾å¤šä¸ªæ•°æ®åº“</p> <p>æ•°æ®åº“é‡Œé¢æœ‰æ•°æ®è¡¨ï¼ˆè¿™é‡Œå«åšé›†åˆï¼‰</p> <p>æ•°æ®è¡¨é‡Œé¢åˆæœ‰å¾ˆå¤šé”®å€¼å¯¹ï¼Œä¹Ÿå°±æ˜¯çœŸæ­£çš„æ•°æ®ï¼ˆè¿™é‡Œå«æ–‡æ¡£ï¼Œjsonæ ¼å¼çš„ï¼‰</p> <p>è¿™é‡Œå­˜å‚¨çš„jsonæ ¼å¼æ•°æ®å«åšbsonï¼ˆjsonçš„å­é›†ï¼‰</p></blockquote> <h2 id="å®˜ç½‘é“¾æ¥"><a href="#å®˜ç½‘é“¾æ¥" aria-hidden="true" class="header-anchor">#</a> å®˜ç½‘é“¾æ¥</h2> <ul><li><a href="https://www.mongodb.com/" target="_blank" rel="noopener noreferrer">è‹±æ–‡å®˜ç½‘<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.mongodb.com/cn" target="_blank" rel="noopener noreferrer">ä¸­æ–‡å®˜ç½‘<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://www.runoob.com/mongodb/mongodb-tutorial.html" target="_blank" rel="noopener noreferrer">èœé¸Ÿæ•™ç¨‹<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.itying.com/category-79-b0-min0-max0-attr0-2-sort_order-DESC.html" target="_blank" rel="noopener noreferrer">è§†é¢‘æ•™ç¨‹<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="å®‰è£…"><a href="#å®‰è£…" aria-hidden="true" class="header-anchor">#</a> å®‰è£…</h2> <h3 id="macå®‰è£…"><a href="#macå®‰è£…" aria-hidden="true" class="header-anchor">#</a> macå®‰è£…</h3> <ol><li>å®‰è£…MongoDBæœ‰ä¸‰ç§æ–¹å¼ï¼šï¼ˆ1ï¼‰æ‰‹åŠ¨å‘½ä»¤å®‰è£…ï¼ˆ2ï¼‰é‡‡ç”¨Homebrewï¼ˆ3ï¼‰ä¸‹è½½å®‰è£…åŒ…,ä¸‹é¢æ•™ç¨‹æ˜¯ç¬¬ä¸‰ç§æ–¹å¼å®‰è£…
<a href="https://www.mongodb.com/download-center/community" target="_blank" rel="noopener noreferrer">ä¸‹è½½åœ°å€<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol> <p><img src="/assets/img/1.616065a9.png" alt="ä¸‹è½½åœ°å€"></p> <ol start="2"><li>å°†ä¸‹è½½ä¸‹æ¥çš„.tgzæ–‡ä»¶è§£å‹åçš„æ–‡ä»¶å¤¹æ”¹åä¸ºmongodb,ç„¶åæ‰“å¼€ç»ˆç«¯ï¼Œè¿›å…¥<code>cd /usr/local</code>ç›®å½•ï¼Œç„¶å<code>open .</code>æ‰“å¼€æ–‡ä»¶å¤¹ï¼Œå°†åˆšåˆšè§£å‹æ”¹åçš„mongodbæ–‡ä»¶å¤¹copyåˆ°localç›®å½•ä¸­</li></ol> <p><img src="/assets/img/2.cd2c95a2.png" alt="ä¸‹è½½åœ°å€"></p> <p><img src="/assets/img/3.ad3440ee.png" alt="ä¸‹è½½åœ°å€"></p> <ol start="3"><li>é…ç½®ç¯å¢ƒå˜é‡ï¼Œæ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥<code>open ~/.bash_profile</code>ï¼Œåœ¨æ‰“å¼€çš„æ–‡ä»¶ä¸­åŠ å…¥</li></ol> <div class="language-powershell extra-class"><pre class="language-powershell"><code>export PATH=$<span class="token punctuation">{</span>PATH<span class="token punctuation">}</span>:<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>mongodb<span class="token operator">/</span>bin
</code></pre></div><p><img src="/assets/img/4.fef08c61.png" alt="ä¸‹è½½åœ°å€"></p> <ol start="4"><li>ä¿å­˜ä¹‹åï¼Œé‡å¯ä¸€ä¸‹bash_profileä½¿ä¹‹ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ</li></ol> <div class="language-powershell extra-class"><pre class="language-powershell"><code>source ~<span class="token operator">/</span><span class="token punctuation">.</span>bash_profile
</code></pre></div><ol start="5"><li>éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸï¼Œ<code>mongod -version</code>å›è½¦åå¦‚æœçœ‹åˆ°ä¸‹é¢çš„ç‰ˆæœ¬å·åˆ™è¯´æ˜MongoDBå·²ç»æˆåŠŸå®‰è£…åˆ°äº†Macä¸Š</li></ol> <div class="language-powershell extra-class"><pre class="language-powershell"><code>mongod <span class="token operator">-</span>version
</code></pre></div><p><img src="/assets/img/5.e8f444fa.png" alt="ä¸‹è½½åœ°å€"></p> <h3 id="æœåŠ¡å™¨centeroså®‰è£…"><a href="#æœåŠ¡å™¨centeroså®‰è£…" aria-hidden="true" class="header-anchor">#</a> æœåŠ¡å™¨CenterOSå®‰è£…</h3> <ol><li>é…ç½®MongoDBçš„yumæº</li></ol> <div class="language-powershell extra-class"><pre class="language-powershell"><code>vim <span class="token operator">/</span>etc<span class="token operator">/</span>yum<span class="token punctuation">.</span>repos<span class="token punctuation">.</span>d<span class="token operator">/</span>mongodb<span class="token operator">-</span>org<span class="token operator">-</span>4<span class="token punctuation">.</span>0<span class="token punctuation">.</span>repo
<span class="token comment"># æ·»åŠ ä»¥ä¸‹é…ç½®</span>
<span class="token namespace">[mongodb-org-4.0]</span>
name=MongoDB Repository
baseurl=https:<span class="token operator">/</span><span class="token operator">/</span>repo<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>org<span class="token operator">/</span>yum<span class="token operator">/</span>redhat<span class="token operator">/</span><span class="token variable">$releasever</span><span class="token operator">/</span>mongodb<span class="token operator">-</span>org<span class="token operator">/</span>4<span class="token punctuation">.</span>0<span class="token operator">/</span>x86_64<span class="token operator">/</span>
gpgcheck=1
enabled=1
gpgkey=https:<span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>org<span class="token operator">/</span>static<span class="token operator">/</span>pgp<span class="token operator">/</span>server<span class="token operator">-</span>4<span class="token punctuation">.</span>0<span class="token punctuation">.</span>asc
</code></pre></div><ol start="2"><li>å®‰è£…MongoDB</li></ol> <div class="language-powershell extra-class"><pre class="language-powershell"><code>yum <span class="token operator">-</span>y install mongodb<span class="token operator">-</span>org
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">æç¤º</p> <p>mongodb-orgå°†è‡ªåŠ¨å®‰è£…ä»¥ä¸‹å››ä¸ªç»„ä»¶åŒ…</p> <ol><li><code>mongodb-org-server</code>ï¼šåŒ…å«mongodå®ˆæŠ¤ç¨‹åºï¼Œå…³è”çš„initè„šæœ¬å’Œé…ç½®æ–‡ä»¶ï¼ˆ<code>/etc/mongod.conf</code>ï¼‰ã€‚æ‚¨å¯ä»¥ä½¿ç”¨åˆå§‹åŒ–è„šæœ¬ä»mongod é…ç½®æ–‡ä»¶å¼€å§‹ã€‚é»˜è®¤æƒ…å†µä¸‹<code>/etc/mongod.conf</code>ï¼Œç¨‹åºåŒ…æä¾›çš„é…ç½®æ–‡ä»¶å·²bind_ipè®¾ç½®ä¸º127.0.0.1ã€‚åœ¨åˆå§‹åŒ–å‰¯æœ¬é›†ä¹‹å‰ï¼Œæ ¹æ®æ‚¨çš„ç¯å¢ƒéœ€è¦ä¿®æ”¹æ­¤è®¾ç½®</li> <li><code>mongodb-org-mongos</code>ï¼šåŒ…å«mongoså®ˆæŠ¤è¿›ç¨‹</li> <li><code>mongodb-org-shell</code>ï¼šåŒ…å«mongoshell</li> <li><code>mongodb-org-tools</code>ï¼šä¸€äº›æ‰©å±•</li></ol></div> <ol start="3"><li>æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ</li></ol> <div class="language-powershell extra-class"><pre class="language-powershell"><code>mongod <span class="token operator">-</span>version  <span class="token comment">#  å‡ºç°db version v4.0.12è¯´æ˜å·²ç»å®‰è£…æˆåŠŸ</span>
</code></pre></div><ol start="4"><li>å¯åŠ¨MongoDBæ•°æ®åº“</li></ol> <div class="language-powershell extra-class"><pre class="language-powershell"><code>systemctl <span class="token function">start</span> mongod   <span class="token comment"># å¯åŠ¨</span>
systemctl restart mongod <span class="token comment"># é‡å¯</span>
systemctl stop mongod    <span class="token comment"># å…³é—­</span>
</code></pre></div><ol start="5"><li>mongod.confçš„é…ç½®ï¼Œæ–‡ä»¶è·¯å¾„ä¸º<code>/etc/mongod.conf</code></li></ol> <div class="language-powershell extra-class"><pre class="language-powershell"><code><span class="token comment"># mongod.conf</span>

<span class="token comment"># for documentation of all options, see:</span>
<span class="token comment">#   http://docs.mongodb.org/manual/reference/configuration-options/</span>

<span class="token comment"># where to write logging data.</span>
systemLog:
  destination: file
  logAppend: true
  path: <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>log<span class="token operator">/</span>mongodb<span class="token operator">/</span>mongod<span class="token punctuation">.</span>log  <span class="token comment"># mongodçš„æ—¥å¿—å­˜æ”¾æ–‡ä»¶è·¯å¾„</span>

<span class="token comment"># Where and how to store data.</span>
storage:
  dbPath: <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>lib<span class="token operator">/</span>mongo      <span class="token comment"># mongodçš„æ•°æ®å­˜æ”¾æ–‡è·¯å¾„</span>
  journal:
    enabled: true
<span class="token comment">#  engine:</span>
<span class="token comment">#  mmapv1:</span>
<span class="token comment">#  wiredTiger:</span>

<span class="token comment"># how the process runs</span>
processManagement:
  fork: true  <span class="token comment"># fork and run in background æ˜¯å¦åå°å¯åŠ¨</span>
  pidFilePath: <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>run<span class="token operator">/</span>mongodb<span class="token operator">/</span>mongod<span class="token punctuation">.</span>pid  <span class="token comment"># location of pidfile</span>
  timeZoneInfo: <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>zoneinfo

<span class="token comment"># network interfaces</span>
net:
  port: 27017 <span class="token comment"># æ•°æ®åº“å¯åŠ¨ç«¯å£ï¼Œå»ºè®®ä¸è¦æ”¹ï¼Œä¸€èˆ¬éƒ½æ˜¯é»˜è®¤27017</span>
  bindIpAll: true <span class="token comment"># bindIpAllå’Œä¸‹é¢çš„bindIpæ˜¯äº’æ–¥çš„ï¼Œå°±æ˜¯è¯´ä¸¤è€…ä¸èƒ½åŒæ—¶å­˜åœ¨ï¼Œé»˜è®¤æ˜¯bindIp: 127.0.0.1</span>
  <span class="token comment"># bindIp: 127.0.0.1  # Enter 0.0.0.0,:: to bind to all IPv4 and IPv6 addresses or, alternatively, use the net.bindIpAll setting.</span>

security:
  authorization: enabled <span class="token comment"># æ‰“å¼€authè®¤è¯  ä½¿ç”¨ç”¨æˆ·åå¯†ç éªŒè¯</span>

<span class="token comment">#operationProfiling:</span>

<span class="token comment">#replication:</span>

<span class="token comment">#sharding:</span>

<span class="token comment">## Enterprise-Only Options</span>

<span class="token comment">#auditLog:</span>

<span class="token comment">#snmp:</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">æç¤º</p> <p>è¿™æ˜¯æˆ‘çš„mongod.confé…ç½®
åœ¨è¿™é‡Œé‡ç‚¹è§£é‡Šä¸€ä¸‹30ï¼Œ31è¿™ä¸¤è¡Œçš„é…ç½®ï¼ŒbindIpAllå’ŒbindIpæ˜¯äº’æ–¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸¤è€…ä¸èƒ½åŒæ—¶å­˜åœ¨ï¼Œé»˜è®¤æ˜¯bindIp: 127.0.0.1ï¼Œæ²¡æœ‰bindIpAll: trueï¼Œå¦‚æœæ˜¯bindIp: 127.0.0.1ï¼Œé‚£ä¹ˆåªèƒ½é€šè¿‡æœ¬æœºè®¿é—®æ•°æ®åº“ï¼Œåšäº†ipè®¿é—®é™åˆ¶ï¼Œå¤–ç½‘åŠnavicatç­‰ç­‰å›¾å½¢åŒ–å·¥å…·æ˜¯æ— æ³•è¿æ¥mongodæ•°æ®åº“çš„ã€‚å¦‚æœæ˜¯bindIpAll: trueï¼Œé‚£ä¹ˆå…¬ç½‘éƒ½æ˜¯å¯ä»¥è®¿é—®çš„</p> <p>å†è§£é‡Šä¸€ä¸‹33, 34è¿™ä¸¤è¡Œ, authorizatioé»˜è®¤æ˜¯disabled,ä¸å¼€å¯ç”¨æˆ·å¯†ç è®¤è¯ï¼Œå…¬ç½‘ä»»ä½•äººéƒ½å¯ä»¥è®¿é—®çš„ï¼Œè¿›æ¥ä¹‹åshow dbså¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„æ•°æ®åº“ï¼Œå¦‚æœé…ç½®äº†authorization: enabledï¼Œæ‰“å¼€è®¤è¯çš„è¯ï¼Œè¿›æ¥ä¹‹åshow dbsä¼šå‘ç°ä¸ä¼šå‡ºç°æ‰€æœ‰æ•°æ®åº“äº†ï¼Œå› ä¸ºè®¾ç½®äº†è´¦æˆ·æƒé™ï¼Œè¦æƒ³æ­£å¸¸è®¿é—®ï¼Œéœ€è¦ä½¿ç”¨è´¦æˆ·åå’Œå¯†ç è¿›å»
<code>mongo admin -u ç”¨æˆ·å -p å¯†ç </code>å³å¯ï¼Œå¦‚æœæ˜¯è®¿é—®è¿œç¨‹æ•°æ®åº“å‘¢ï¼Œå‘½ä»¤å¦‚ä¸‹<code>mongo 192.168.1.200:27017/&lt;test&gt; -u &lt;user&gt; -p &lt;password&gt;</code>,å…¶ä¸­&lt;test&gt;æ•°æ®åº“åç§°ï¼Œ &lt;user&gt;ç”¨æˆ·è´¦å·ï¼Œ &lt;password&gt;ç”¨æˆ·å¯†ç </p></div> <ol start="6"><li>MongoDBé…ç½®ç”¨æˆ·åå¯†ç æƒé™</li></ol> <p>åœ¨æœåŠ¡å™¨ä¸Šé€šè¿‡<code>mongo</code>å‘½ä»¤ï¼Œç›´æ¥è¿›å…¥åˆ°mongoshellä¸­ï¼Œç„¶å<code>show dbs</code>ä¼šå‡ºç°ä¸‰ä¸ªé»˜è®¤çš„åº“admin config localï¼Œ</p> <div class="language-powershell extra-class"><pre class="language-powershell"><code>&gt; show dbs
admin   0<span class="token punctuation">.</span>000GB
config  0<span class="token punctuation">.</span>000GB
local   0<span class="token punctuation">.</span>000GB
&gt; use admin   <span class="token comment"># è¿›å…¥åˆ°adminè¿™ä¸ªåº“ä¸­</span>
switched to db admin
&gt; show collections <span class="token comment"># æˆ–è€…ä¹Ÿå¯ä»¥ç”¨ show tables æŸ¥çœ‹å½“å‰adminåº“é‡Œé¢æœ‰å“ªäº›è¡¨</span>
system<span class="token punctuation">.</span>users
system<span class="token punctuation">.</span>version
users
&gt; db<span class="token punctuation">.</span>createUser<span class="token punctuation">(</span><span class="token punctuation">{</span>user:<span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span><span class="token function">pwd</span>:<span class="token string">&quot;admin123&quot;</span><span class="token punctuation">,</span>roles:<span class="token punctuation">[</span><span class="token punctuation">{</span>role:<span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span> db:<span class="token string">&quot;admin&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment"># åˆ›å»ºè¶…çº§ç®¡ç†å‘˜ ,å¯ä»¥ç™»é™†æ“ä½œå…¨éƒ¨çš„æ•°æ®åº“</span>
Successfully added user: <span class="token punctuation">{</span>
	<span class="token string">&quot;user&quot;</span> : <span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;roles&quot;</span> : <span class="token punctuation">[</span>
		<span class="token punctuation">{</span>
			<span class="token string">&quot;role&quot;</span> : <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span>
			<span class="token string">&quot;db&quot;</span> : <span class="token string">&quot;admin&quot;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
&gt; db<span class="token punctuation">.</span>createUser<span class="token punctuation">(</span><span class="token punctuation">{</span>user:<span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span><span class="token function">pwd</span>:<span class="token string">&quot;admin123&quot;</span><span class="token punctuation">,</span>roles:<span class="token punctuation">[</span><span class="token punctuation">{</span>role:<span class="token string">&quot;userAdminAnyDatabase&quot;</span><span class="token punctuation">,</span>db:<span class="token string">&quot;admin&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment"># åˆ›å»ºç”¨æˆ·è§’è‰²ç®¡ç†å‘˜ ,å¯ä»¥æ·»åŠ ç”¨æˆ·</span>
Successfully added user: <span class="token punctuation">{</span>
	<span class="token string">&quot;user&quot;</span> : <span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;roles&quot;</span> : <span class="token punctuation">[</span>
		<span class="token punctuation">{</span>
			<span class="token string">&quot;role&quot;</span> : <span class="token string">&quot;userAdminAnyDatabase&quot;</span><span class="token punctuation">,</span>
			<span class="token string">&quot;db&quot;</span> : <span class="token string">&quot;admin&quot;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
&gt; use weChat <span class="token comment"># åˆ›å»ºä¸€ä¸ªåå­—å«åšweChatæ•°æ®åº“</span>
&gt; show dbs
admin   0<span class="token punctuation">.</span>000GB
config  0<span class="token punctuation">.</span>000GB
local   0<span class="token punctuation">.</span>000GB
weChat  0<span class="token punctuation">.</span>000GB <span class="token comment"># æ­¤æ—¶å·²æˆåŠŸåˆ›å»ºåå­—ä¸ºweChatè¿™ä¸ªæ•°æ®åº“äº†</span>
&gt; db<span class="token punctuation">.</span>createUser<span class="token punctuation">(</span><span class="token punctuation">{</span>user: <span class="token string">'test'</span><span class="token punctuation">,</span> <span class="token function">pwd</span>: <span class="token string">'test123'</span><span class="token punctuation">,</span> roles: <span class="token punctuation">[</span><span class="token punctuation">{</span>role: <span class="token string">'readWrite'</span><span class="token punctuation">,</span> db: <span class="token string">'weChat'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment"># åˆ›å»ºä¸€ä¸ªæ™®é€šç”¨æˆ·ï¼Œå¯¹weChatæ•°æ®åº“åªæœ‰è¯»å†™æƒé™</span>
&gt; db<span class="token punctuation">.</span>system<span class="token punctuation">.</span>users<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;user&quot;</span>: <span class="token string">&quot;test&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment"># åˆ é™¤testç”¨æˆ·</span>
</code></pre></div><p>ç„¶åä½ å°±å¯ä»¥é€šè¿‡ <code>mongo 192.168.1.200:27017/weChat -u test -p test123</code> è¿™æ ·è¿æ¥æ•°æ®åº“</p> <h4 id="å…·ä½“ç”¨æˆ·æƒé™"><a href="#å…·ä½“ç”¨æˆ·æƒé™" aria-hidden="true" class="header-anchor">#</a> å…·ä½“ç”¨æˆ·æƒé™</h4> <ul><li><p><strong>read</strong>ï¼šå…è®¸ç”¨æˆ·è¯»å–æŒ‡å®šæ•°æ®åº“</p></li> <li><p><strong>readWrite</strong>ï¼šå…è®¸ç”¨æˆ·è¯»å†™æŒ‡å®šæ•°æ®åº“</p></li> <li><p><strong>dbAdmin</strong>ï¼šå…è®¸ç”¨æˆ·åœ¨æŒ‡å®šæ•°æ®åº“ä¸­æ‰§è¡Œç®¡ç†å‡½æ•°ï¼Œå¦‚ç´¢å¼•åˆ›å»ºã€åˆ é™¤ï¼ŒæŸ¥çœ‹ç»Ÿè®¡æˆ–è®¿é—®system.profile</p></li> <li><p><strong>userAdmin</strong>ï¼šå…è®¸ç”¨æˆ·å‘system.usersé›†åˆå†™å…¥ï¼Œå¯ä»¥æ‰¾æŒ‡å®šæ•°æ®åº“é‡Œåˆ›å»ºã€åˆ é™¤å’Œç®¡ç†ç”¨æˆ·</p></li> <li><p><strong>clusterAdmin</strong>ï¼šåªåœ¨adminæ•°æ®åº“ä¸­å¯ç”¨ï¼Œèµ‹äºˆç”¨æˆ·æ‰€æœ‰åˆ†ç‰‡å’Œå¤åˆ¶é›†ç›¸å…³å‡½æ•°çš„ç®¡ç†æƒé™ã€‚</p></li> <li><p><strong>readAnyDatabase</strong>ï¼šåªåœ¨adminæ•°æ®åº“ä¸­å¯ç”¨ï¼Œèµ‹äºˆç”¨æˆ·æ‰€æœ‰æ•°æ®åº“çš„è¯»æƒé™</p></li> <li><p><strong>readWriteAnyDatabase</strong>ï¼šåªåœ¨adminæ•°æ®åº“ä¸­å¯ç”¨ï¼Œèµ‹äºˆç”¨æˆ·æ‰€æœ‰æ•°æ®åº“çš„è¯»å†™æƒé™</p></li> <li><p><strong>userAdminAnyDatabase</strong>ï¼šåªåœ¨adminæ•°æ®åº“ä¸­å¯ç”¨ï¼Œèµ‹äºˆç”¨æˆ·æ‰€æœ‰æ•°æ®åº“çš„userAdminæƒé™</p></li> <li><p><strong>dbAdminAnyDatabase</strong>ï¼šåªåœ¨adminæ•°æ®åº“ä¸­å¯ç”¨ï¼Œèµ‹äºˆç”¨æˆ·æ‰€æœ‰æ•°æ®åº“çš„dbAdminæƒé™ã€‚</p></li> <li><p><strong>root</strong>ï¼šåªåœ¨adminæ•°æ®åº“ä¸­å¯ç”¨ã€‚è¶…çº§è´¦å·ï¼Œè¶…çº§æƒé™ã€‚</p></li> <li><p>é…ç½®æˆåŠŸä¹‹åï¼Œå…¬ç½‘å¯ä»¥é€šè¿‡è´¦å·å¯†ç è®¿é—®æ•°æ®äº†</p></li></ul> <ol start="7"><li>MongoDBå›¾å½¢åŒ–å·¥å…·</li></ol> <p><a href="https://robomongo.org/download" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ¨èå·¥å…· Robo 3T<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://www.navicat.com.cn/download/navicat-for-mongodb" target="_blank" rel="noopener noreferrer">navicat<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ol start="8"><li>navicatè¿æ¥mongodbæ•°æ®åº“å</li></ol> <p><img src="/assets/img/6.945afc69.jpg" alt="6.jpg"></p> <h2 id="mongoose"><a href="#mongoose" aria-hidden="true" class="header-anchor">#</a> mongoose</h2> <h3 id="å®‰è£…mongoose"><a href="#å®‰è£…mongoose" aria-hidden="true" class="header-anchor">#</a> å®‰è£…mongoose</h3> <div class="language-powershell extra-class"><pre class="language-powershell"><code>  npm i mongoose <span class="token operator">-</span>s
</code></pre></div><h3 id="å¼•å…¥mongooseå¹¶è¿æ¥mongodb"><a href="#å¼•å…¥mongooseå¹¶è¿æ¥mongodb" aria-hidden="true" class="header-anchor">#</a> å¼•å…¥mongooseå¹¶è¿æ¥mongodb</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span>
<span class="token comment">// è¿æ¥æ•°æ®åº“æ ¼å¼</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://[ip]:[port]/[dataBase]'</span><span class="token punctuation">)</span>
<span class="token comment">// ç¤ºä¾‹</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://132.232.36.133:27017/test'</span><span class="token punctuation">)</span>
</code></pre></div><p>å¦‚æœæ•°æ®åº“é…ç½®äº†è´¦æˆ·å¯†ç </p> <div class="language-js extra-class"><pre class="language-js"><code>mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://admin:admin123@localhost:27017/test'</span><span class="token punctuation">)</span>
<span class="token comment">// ä¹Ÿå¯ä»¥è¿™ä¹ˆè¿æ¥</span>
mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'mongodb://localhost:27017/test'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    user<span class="token punctuation">:</span> <span class="token string">'admin'</span><span class="token punctuation">,</span>
    pass<span class="token punctuation">:</span> <span class="token string">'admin123'</span><span class="token punctuation">,</span>
    useNewUrlParser<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="schema"><a href="#schema" aria-hidden="true" class="header-anchor">#</a> schema</h3> <ul><li><p><a href="http://www.mongoosejs.net/docs/schematypes.html" target="_blank" rel="noopener noreferrer">schemaæ¨¡å‹æ–‡æ¡£<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p>ä»€ä¹ˆæ˜¯schema?schemaå¯ä»¥ç†è§£ä¸ºæ•°æ®åº“å¯¹è±¡çš„é›†åˆï¼Œschemaæ˜¯mongooseä¼šç”¨åˆ°çš„ä¸€ç§æ•°æ®æ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯è¡¨ç»“æ„çš„å®šä¹‰ã€‚æ¯ä¸€ä¸ªschemaä¼šæ˜ å°„åˆ°mongodb  ä¸­çš„ä¸€ä¸ªcollectionï¼Œæ•°æ®æ¨¡å‹ æ•°æ®ç»“æ„ï¼Œä¾‹å¦‚æœ€ç®€å•çš„ä¸€ä¸ªschema { name: String, age: Number, pwd: String }</p></li> <li><p>ä¸¾ä¸ªæ³¨å†Œæ¥å£çš„schemaï¼Œè¿™é‡Œé¢å¯ä»¥å¯¹æ¯ä¸€ä¸ªå­—æ®µè¿›è¡Œæ ¡éªŒ(mongooseè‡ªå¸¦çš„ <strong>é¢„å®šä¿®é¥°ç¬¦</strong>)ï¼ŒåŒ…æ‹¬å­—æ®µçš„ç±»å‹ï¼Œæ˜¯å¦å¿…å¡«ï¼Œæ­£åˆ™æ ¡éªŒç­‰ç­‰...</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> RegisterSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  phone<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    required<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">'phone is required'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    trim<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    validate<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function">validator</span> <span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">/</span><span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">|</span><span class="token number">4</span><span class="token operator">|</span><span class="token number">5</span><span class="token operator">|</span><span class="token number">6</span><span class="token operator">|</span><span class="token number">7</span><span class="token operator">|</span><span class="token number">8</span><span class="token operator">|</span><span class="token number">9</span><span class="token punctuation">)</span>\d<span class="token punctuation">{</span><span class="token number">9</span><span class="token punctuation">}</span>$<span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">message</span><span class="token punctuation">:</span> <span class="token parameter">props</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>props<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is not a valid phone number!</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  email<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    required<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">'email is required'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    trim<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    validate<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function">validator</span> <span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">/</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token constant">A</span><span class="token operator">-</span>Za<span class="token operator">-</span>z0<span class="token operator">-</span><span class="token number">9</span>_\<span class="token operator">-</span>\<span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span>\@<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token constant">A</span><span class="token operator">-</span>Za<span class="token operator">-</span>z0<span class="token operator">-</span><span class="token number">9</span>_\<span class="token operator">-</span>\<span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span>\<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token constant">A</span><span class="token operator">-</span>Za<span class="token operator">-</span>z<span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">)</span>$<span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">message</span><span class="token punctuation">:</span> <span class="token parameter">props</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>props<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is not a valid email!</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  password<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    required<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    minlength<span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
    maxlength<span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
    trim<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  RegisterModel<span class="token punctuation">:</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> RegisterSchema<span class="token punctuation">)</span>
  <span class="token comment">// æ³¨æ„è¿™é‡Œçš„User, é»˜è®¤æ“ä½œçš„æ˜¯usersè¡¨ï¼Œå› ä¸ºmongodbé»˜è®¤ä¼šå°†æ‰€æœ‰çš„è¡¨åå­—åé¢éƒ½åŠ ä¸€ä¸ª`s`</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>ä½¿ç”¨schemaæ•°æ®æ¨¡å‹ï¼Œå¯¹mongodbè¿›è¡Œ å¢åˆ æ”¹æŸ¥</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> Model <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./model'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> RegisterModel <span class="token punctuation">}</span> <span class="token operator">=</span> Model
<span class="token comment">// -------------------------- åˆ†å‰²çº¿ å¢åŠ æ•°æ® --------------------------</span>
<span class="token comment">// é¦–å…ˆå…ˆè¦å®ä¾‹åŒ–model</span>
<span class="token keyword">const</span> m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegisterModel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  phone<span class="token punctuation">:</span> <span class="token string">'13811112222'</span><span class="token punctuation">,</span>
  email<span class="token punctuation">:</span> <span class="token string">'123456@163.com'</span><span class="token punctuation">,</span>
  password<span class="token punctuation">:</span> <span class="token string">'qwer123'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// æ³¨æ„ï¼šæ“ä½œæ•°æ®åº“å¢åˆ æ”¹æŸ¥éƒ½æ˜¯å¼‚æ­¥çš„æ“ä½œ</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  m<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// -------------------------- åˆ†å‰²çº¿ æŸ¥è¯¢æ•°æ® --------------------------</span>
<span class="token comment">// æŸ¥æ‰¾å¤šæ¡ç¬¦åˆæ¡ä»¶çš„æ•°æ® Model.find([conditions], [callback]) conditionsæŸ¥æ‰¾æ¡ä»¶ï¼Œ callbackå›è°ƒå‡½æ•° Model.find({age: 18}, callback)</span>
<span class="token comment">// æŸ¥æ‰¾ä¸€æ¡ç¬¦åˆæ¡ä»¶çš„æ•°æ® modModelel.findOne(conditions, [callback]) conditionsæŸ¥æ‰¾æ¡ä»¶ï¼Œ callbackå›è°ƒå‡½æ•° Model.findOne({username:'admin'}, callback)</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  RegisterModel<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// -------------------------- åˆ†å‰²çº¿ æ›´æ–°æ•°æ® --------------------------</span>
<span class="token comment">// æ ¹æ®æ¡ä»¶æ›´æ–°æ‰€æœ‰ Model.update(conditions, doc ,[options], [callback])</span>
<span class="token comment">// æ ¹æ®æŒ‡å®šæ¡ä»¶æ›´æ–°ä¸€ä¸ª Model.findOneAndUpdate([conditions], [update], [options], [callback])</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  RegisterModel<span class="token punctuation">.</span><span class="token function">updateOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>userName<span class="token punctuation">:</span> <span class="token string">'admin'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>password<span class="token punctuation">:</span> <span class="token string">'admin23'</span><span class="token punctuation">}</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// -------------------------- åˆ†å‰²çº¿ åˆ é™¤æ•°æ® --------------------------</span>
<span class="token comment">// Model.remove(conditions, [callback])</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  RegisterModel<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">{</span>userName<span class="token punctuation">:</span> <span class="token string">'admin'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="schemaè‡ªå®šä¹‰æ¨¡å¼ä¿®é¥°ç¬¦-setters-getters"><a href="#schemaè‡ªå®šä¹‰æ¨¡å¼ä¿®é¥°ç¬¦-setters-getters" aria-hidden="true" class="header-anchor">#</a> schemaè‡ªå®šä¹‰æ¨¡å¼ä¿®é¥°ç¬¦ Setters &amp; Getters</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Setters æ¯”å¦‚è¯´ï¼šæœ‰ä¸€ä¸ªurlå­—æ®µï¼Œå°†è¯¥å­—æ®µå¦‚æœæœ‰ `http://` åˆ™ä¿æŒç°çŠ¶ï¼Œå¦‚æœæ²¡æœ‰åˆ™æ·»åŠ ` http://`</span>
url<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
  required<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">'url is required'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  trim<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token keyword">set</span> <span class="token punctuation">(</span>params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//  åœ¨è¿™é‡Œparamså¯ä»¥è·å–urlå­—æ®µçš„å€¼ï¼Œè¿”å›çš„æ•°æ®å°±æ˜¯urlåœ¨æ•°æ®åº“ä¸­å®é™…ä¿å­˜çš„å€¼</span>
    <span class="token comment">// ä¾‹å¦‚ï¼šå‰ç«¯ä¼ å…¥çš„å­—æ®µæ˜¯www.baidu.com, æˆ‘ä»¬ç»è¿‡å¤„ç†è‡ªåŠ¨è½¬æ¢ä¸º http://www.baidu.comå¹¶å­˜å…¥æ•°æ®åº“ä¸­</span>
    <span class="token keyword">const</span> <span class="token constant">REG</span> <span class="token operator">=</span> <span class="token regex">/^http:\/\//</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token constant">REG</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>params<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> params
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Getters ä¸€èˆ¬æ²¡ä»€ä¹ˆåµç”¨</span>
<span class="token keyword">const</span> PhoneSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  phone<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    required<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">'phone is required'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    trim<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    validate<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function">validator</span> <span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">/</span><span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">|</span><span class="token number">4</span><span class="token operator">|</span><span class="token number">5</span><span class="token operator">|</span><span class="token number">6</span><span class="token operator">|</span><span class="token number">7</span><span class="token operator">|</span><span class="token number">8</span><span class="token operator">|</span><span class="token number">9</span><span class="token punctuation">)</span>\d<span class="token punctuation">{</span><span class="token number">9</span><span class="token punctuation">}</span>$<span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">message</span><span class="token punctuation">:</span> <span class="token parameter">props</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>props<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is not a valid phone number!</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">get</span> <span class="token punctuation">(</span>params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">+86</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>params<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> PhoneModel <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'Phone'</span><span class="token punctuation">,</span> PhoneSchema<span class="token punctuation">,</span> <span class="token string">'phones'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PhoneModel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  phone<span class="token punctuation">:</span> <span class="token string">'13811112222'</span><span class="token punctuation">,</span>
  email<span class="token punctuation">:</span> <span class="token string">'123456@163.com'</span><span class="token punctuation">,</span>
  password<span class="token punctuation">:</span> <span class="token string">'qwer123'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>phone<span class="token punctuation">)</span> <span class="token comment">// +8613811112222</span>
</code></pre></div><!----></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/duanxiongfei-2016/notes.git/edit/master/node/mongoDB.md" target="_blank" rel="noopener noreferrer">åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">41 åˆ†é’Ÿå‰</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/node/koa2.html" class="prev">Koa2</a></span> <!----></p></div> </main></div><div class="global-ui"><!----><div id="live2d-widget" class="live2d-widget-container" style="position:fixed;right:65px;bottom:0px;width:135px;height:300px;z-index:99999;opacity:0.8;pointer-events:none;"><canvas id="live2dcanvas" width="135" height="300" class="live2dcanvas" style="position:absolute;left:0px;top:0px;width:135px;height:300px;"></canvas></div></div></div>
    <script src="/assets/js/app.260082ab.js" defer></script><script src="/assets/js/2.abe796d4.js" defer></script><script src="/assets/js/13.92e9db98.js" defer></script>
  </body>
</html>
